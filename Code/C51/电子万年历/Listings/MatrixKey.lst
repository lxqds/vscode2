C51 COMPILER V9.60.0.0   MATRIXKEY                                                         06/26/2022 15:37:16 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MATRIXKEY
OBJECT MODULE PLACED IN .\Objects\MatrixKey.obj
COMPILER INVOKED BY: D:\KeilMDKArm\C51\BIN\C51.EXE Hardware\MatrixKey.c OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRINT(.\List
                    -ings\MatrixKey.lst) TABS(2) OBJECT(.\Objects\MatrixKey.obj)

line level    source

   1          #include ".\Library\STC15F.H"
   2          #include ".\Hardware\MatrixKey.h"
   3          //Keyboard
   4          sbit ROW1 = P0^3;
   5          sbit ROW2 = P0^2;
   6          sbit ROW3 = P0^1;
   7          sbit ROW4 = P0^0;
   8          sbit LINE1 = P4^6;
   9          sbit LINE2 = P4^5;
  10          sbit LINE3 = P2^7;
  11          sbit LINE4 = P2^6;
  12          
  13          unsigned char Key_KeyNumber=0;
  14          
  15          /**
  16            * @brief  è·å–æŒ‰é”®é”®ç 
  17            * @param  æ— 
  18            * @retval æŒ‰ä¸‹æŒ‰é”®çš„é”®ç ï¼ŒèŒƒå›´ï¼š0,1~16,0è¡¨ç¤ºæ— æŒ‰é”®æŒ‰ä¸‹
  19            */
  20          unsigned char MatrixKey()
  21          {
  22   1        unsigned char Temp=0;
  23   1        Temp=Key_KeyNumber;
  24   1        Key_KeyNumber=0;
  25   1        return Temp;
  26   1      }
  27          /**
  28            * @brief  è·å–å½“å‰æŒ‰é”®çš„çŠ¶æ€ï¼Œæ— æ¶ˆæŠ–åŠæ¾æ‰‹æ£€æµ‹
  29            * @param  æ— 
  30            * @retval æŒ‰ä¸‹æŒ‰é”®çš„é”®ç ï¼ŒèŒƒå›´ï¼š0,1~16,0è¡¨ç¤ºæ— æŒ‰é”®æŒ‰ä¸‹
  31            */
  32          unsigned char Key_GetState()
  33          {
  34   1        unsigned char KeyNumber=0;
  35   1        ROW1=ROW2=ROW3=ROW4=1;
  36   1        ROW1=0;
  37   1        if(LINE1==0){KeyNumber=13;}
  38   1        if(LINE2==0){KeyNumber=14;}
  39   1        if(LINE3==0){KeyNumber=15;}
  40   1        if(LINE4==0){KeyNumber=16;}
  41   1        ROW1=ROW2=ROW3=ROW4=1;
  42   1        ROW2=0;
  43   1        if(LINE1==0){KeyNumber=9;}
  44   1        if(LINE2==0){KeyNumber=10;}
  45   1        if(LINE3==0){KeyNumber=11;}
  46   1        if(LINE4==0){KeyNumber=12;}
  47   1        ROW1=ROW2=ROW3=ROW4=1;
  48   1        ROW3=0;
  49   1        if(LINE1==0){KeyNumber=5;}
  50   1        if(LINE2==0){KeyNumber=6;}
  51   1        if(LINE3==0){KeyNumber=7;}
  52   1        if(LINE4==0){KeyNumber=8;}
  53   1        ROW1=ROW2=ROW3=ROW4=1;
  54   1        ROW4=0;
C51 COMPILER V9.60.0.0   MATRIXKEY                                                         06/26/2022 15:37:16 PAGE 2   

  55   1        if(LINE1==0){KeyNumber=1;}
  56   1        if(LINE2==0){KeyNumber=2;}
  57   1        if(LINE3==0){KeyNumber=3;}
  58   1        if(LINE4==0){KeyNumber=4;}
  59   1        
  60   1      
  61   1        return KeyNumber;
  62   1      }
  63          /**
  64            * @brief  æŒ‰é”®é©±åŠ¨å‡½æ•°ï¼Œåœ¨ä¸­æ–­ä¸­è°ƒç”¨
  65            * @param  æ— 
  66            * @retval æ— 
  67            */
  68          void MatrixKey_Loop(void)
  69          {
  70   1        static unsigned char NowState,LastState;
  71   1        LastState=NowState;       //æŒ‰é”®çŠ¶æ€æ›´æ–°
  72   1        NowState=Key_GetState();    //è·å–å½“å‰æŒ‰é”®çŠ¶æ€
  73   1        //å¦‚æœä¸Šä¸ªæ—¶é—´ç‚¹æŒ‰é”®æŒ‰ä¸‹ï¼Œè¿™ä¸ªæ—¶é—´ç‚¹æœªæŒ‰ä¸‹ï¼Œåˆ™æ˜¯æ¾æ‰‹ç¬é—´ï¼Œä»¥æ­¤é¿å…æ¶ˆæŠ–å
             -’Œæ¾æ‰‹æ£€æµ‹
  74   1        if(LastState==1 && NowState==0){Key_KeyNumber=1;}
  75   1        if(LastState==2 && NowState==0){Key_KeyNumber=2;}
  76   1        if(LastState==3 && NowState==0){Key_KeyNumber=3;}
  77   1        if(LastState==4 && NowState==0){Key_KeyNumber=4;}
  78   1        if(LastState==5 && NowState==0){Key_KeyNumber=5;}
  79   1        if(LastState==6 && NowState==0){Key_KeyNumber=6;}
  80   1        if(LastState==7 && NowState==0){Key_KeyNumber=7;}
  81   1        if(LastState==8 && NowState==0){Key_KeyNumber=8;}
  82   1        if(LastState==9 && NowState==0){Key_KeyNumber=9;}
  83   1        if(LastState==10 && NowState==0){Key_KeyNumber=10;}
  84   1        if(LastState==11 && NowState==0){Key_KeyNumber=11;}
  85   1        if(LastState==12 && NowState==0){Key_KeyNumber=12;}
  86   1        if(LastState==13 && NowState==0){Key_KeyNumber=13;}
  87   1        if(LastState==14 && NowState==0){Key_KeyNumber=14;}
  88   1        if(LastState==15 && NowState==0){Key_KeyNumber=15;}
  89   1        if(LastState==16 && NowState==0){Key_KeyNumber=16;}
  90   1      } 


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    361    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
