C51 COMPILER V9.60.0.0   CLOCK                                                             06/26/2022 13:43:19 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE CLOCK
OBJECT MODULE PLACED IN .\Objects\Clock.obj
COMPILER INVOKED BY: D:\KeilMDKArm\C51\BIN\C51.EXE Hardware\Clock.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\
                    -Listings\Clock.lst) TABS(2) OBJECT(.\Objects\Clock.obj)

line level    source

   1          #include <STC15F2K60S2.H>
*** WARNING C318 IN LINE 1 OF Hardware\Clock.c: can't open file 'STC15F2K60S2.H'
   2          #include "oled.h"
*** WARNING C318 IN LINE 31 OF Hardware\oled.h: can't open file 'STC15F2K60S2.H'
*** ERROR C202 IN LINE 42 OF Hardware\oled.h: 'P1': undefined identifier
*** ERROR C202 IN LINE 43 OF Hardware\oled.h: 'P1': undefined identifier
*** ERROR C202 IN LINE 44 OF Hardware\oled.h: 'P4': undefined identifier
*** ERROR C202 IN LINE 45 OF Hardware\oled.h: 'P1': undefined identifier
*** ERROR C202 IN LINE 46 OF Hardware\oled.h: 'P1': undefined identifier
   3          #include "DS1302.h"
   4          #include "Timer1.h"
   5          #include "Time0.h"
   6          #include "MATRIXKEY.h"
   7          #include "Clock.h"
   8          #include "DHT11.h"
   9          
  10          unsigned char Clock_Week_Calc(unsigned int y, unsigned char m, unsigned char d)    // 星期计算
  11          {
  12   1          unsigned int Week_Cnt = 0;
  13   1          unsigned char Week_Num;
  14   1      
  15   1          switch (m) {     // 从这一年的元旦算到该天为止( 含该天) 的天数
  16   2              case 12: Week_Cnt += 30;
  17   2              case 11: Week_Cnt += 31;
  18   2              case 10: Week_Cnt += 30;
  19   2              case  9: Week_Cnt += 31;
  20   2              case  8: Week_Cnt += 31;
  21   2              case  7: Week_Cnt += 30;
  22   2              case  6: Week_Cnt += 31;
  23   2              case  5: Week_Cnt += 30;
  24   2              case  4: Week_Cnt += 31;
  25   2              case  3: Week_Cnt += 28;
  26   2              case  2: Week_Cnt += 31;
  27   2              case  1: Week_Cnt += d; break;
  28   2              default: break;
  29   2          }
  30   1          if ((!(y % 4) && ((y % 100) || !(y % 400))) && (m > 2)) // 闰年补一天
  31   1          {    
  32   2              Week_Cnt++;
  33   2          }
  34   1          Week_Num = (y - 1 + (y - 1) / 4 - (y - 1) / 100 + (y - 1) / 400 + Week_Cnt) % 7;
  35   1      
  36   1          return Week_Num;
  37   1      }
  38          void Clock_Time_To_DS1302()//将时间写入DS1302
  39          {
  40   1          DS1302_Time[0] = Time.Year;
  41   1          DS1302_Time[1] = Time.Month;
  42   1          DS1302_Time[2] = Time.Day;
  43   1          DS1302_Time[3] = Time.Hour;
  44   1          DS1302_Time[4] = Time.Minute;
  45   1          DS1302_Time[5] = Time.Second;
  46   1      //    DS1302_Time[6] = Time.Week;
  47   1          DS1302_SetTime();
C51 COMPILER V9.60.0.0   CLOCK                                                             06/26/2022 13:43:19 PAGE 2   

  48   1      }
  49          void Clock_Display_Init()//时间初始化
  50          {
  51   1          DS1302_ReadTime();
  52   1          Time.Year = DS1302_Time[0];
  53   1          Time.Month = DS1302_Time[1];
  54   1          Time.Day = DS1302_Time[2];
  55   1          Time.Hour = DS1302_Time[3];
  56   1          Time.Minute = DS1302_Time[4];
  57   1          Time.Second = DS1302_Time[5];
  58   1          Time.Week = Clock_Week_Calc(Time.Year,Time.Month,Time.Day);
  59   1          OLED_ShowNum(8,0,20,2,16);
  60   1          OLED_ShowNum(24,0,Time.Year,2,16);
  61   1          OLED_ShowCHinese(40,0,7);//年
  62   1          OLED_ShowNum(56,0,Time.Month,2,16);
  63   1          OLED_ShowCHinese(72,0,8);//月
  64   1          OLED_ShowNum(88,0,Time.Day,2,16);
  65   1          OLED_ShowCHinese(104,0,9);//日
  66   1          OLED_ShowNum(16,2,Time.Hour,2,16);
  67   1          OLED_ShowCHinese(32,2,10);//时
  68   1          OLED_ShowNum(48,2,Time.Minute,2,16);
  69   1          OLED_ShowCHinese(64,2,11);//分
  70   1          OLED_ShowNum(80,2,Time.Second,2,16);
  71   1          OLED_ShowCHinese(96,2,12);//秒
  72   1      
  73   1          OLED_ShowCHinese(40,4,13);//星
  74   1          OLED_ShowCHinese(56,4,14);//期
  75   1          OLED_ShowCHinese(72,4,Time.Week);//天
  76   1      } 
  77          
  78          
  79          void Clock_Display_Update()
  80          {
  81   1        switch(Time_Update)//判断更新
  82   1        {
  83   2          case 1: Time_Update = 0;
  84   2                  OLED_ShowNum(24,0,Time.Year,2,16);//更新年
  85   2          case 2: Time_Update = 0;
  86   2                  OLED_ShowNum(56,0,Time.Month,2,16);//月
  87   2          case 3: Time_Update = 0;
  88   2                  OLED_ShowNum(88,0,Time.Day,2,16);//日
  89   2                  OLED_ShowCHinese(72,4,Clock_Week_Calc(Time.Year,Time.Month,Time.Day));//天
  90   2          case 4: Time_Update = 0;
  91   2                  OLED_ShowNum(16,2,Time.Hour,2,16);//时
  92   2          case 5: Time_Update = 0;
  93   2                  OLED_ShowNum(48,2,Time.Minute,2,16);//分
  94   2          case 6: Time_Update = 0;
  95   2                  OLED_ShowNum(80,2,Time.Second,2,16);//秒
  96   2                  break;
  97   2                  
  98   2          default:break;
  99   2          
 100   2        }
 101   1      }

C51 COMPILATION COMPLETE.  2 WARNING(S),  5 ERROR(S)
