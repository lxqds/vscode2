C51 COMPILER V9.60.0.0   MAIN                                                              06/29/2022 07:58:28 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\KeilMDKArm\C51\BIN\C51.EXE main.c OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRINT(.\Listings\main.lst)
                    - TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2           * @Description:
   3           * @Author: huacong
   4           * @Date: 2022-06-26 15:48:24
   5           * @LastEditTime: 2022-06-29 07:57:37
   6           * @LastEditors: huacong
   7           */
   8          #include "main.h"
   9          #include ".\Hardware\Delay.h" /* 意思是当前目录的Hardware目录下的Delay.h文件 */
  10          #include ".\Hardware\MatrixKey.h"
  11          #include ".\Hardware\SPIOled.h"
  12          #include ".\Hardware\Timer1.h"
  13          #include ".\Hardware\DS1302.h"
  14          
  15          /**
  16           * @description: 根据按键值改变状态值
  17           * @return {*}
  18           * @param {unsigned char} *Key
  19           * @param {unsigned char} *State
  20           */
  21           void Key_Change_State(unsigned char *Key, unsigned char *State)
  22          {
  23   1      
  24   1        switch (*Key)
  25   1        {
  26   2        case 1:
  27   2          *State = 1;
  28   2          break;
  29   2        case 2:
  30   2          *State = 2;
  31   2          break;
  32   2        case 3:
  33   2          *State = 3;
  34   2          break;
  35   2        case 4:
  36   2          *State = 4;
  37   2          break;
  38   2        case 5:
  39   2          *State = 5;
  40   2          break;
  41   2        case 6:
  42   2          *State = 6;
  43   2          break;
  44   2        default:
  45   2          break;
  46   2        }
  47   1      }
  48          /**
  49           * @description:显示菜单
  50           * @return {*}
  51           * @param {unsigned char} i
  52           */
  53          void Menu_Display(unsigned char i)
  54          {
C51 COMPILER V9.60.0.0   MAIN                                                              06/29/2022 07:58:28 PAGE 2   

  55   1        switch (i)
  56   1        {
  57   2        case 0:
  58   2          OLED_Printf(32, 0, "Menu");
  59   2          OLED_Printf(0, 2, "1.Change Time");
  60   2          OLED_Printf(0, 4, "2.Set Clock");
  61   2          OLED_Printf(0, 6, "3.StopWatch");
  62   2          break;
  63   2        case 1:
  64   2          OLED_Printf(32, 0, "Menu2");
  65   2          OLED_Printf(0, 2, "4.Change Time");
  66   2          OLED_Printf(0, 4, "5.Set Clock");
  67   2          OLED_Printf(0, 6, "6.StopWatch");
  68   2          break;
  69   2        }
  70   1      }
  71          void main()
  72          {
  73   1        unsigned char Key = 0, Next_State = 0, State = 0,Time[7]={0},Time_Change[7]={0},Display=0;
  74   1        OLED_Init();
  75   1        Timer1Init();
  76   1        DS1302_Init();
  77   1        while (1)
  78   1        {
  79   2          Key = MatrixKey();
  80   2          if (Key)
  81   2          {
  82   3            Key %= 15; /* 去除0的时候表示没有按下,同时16表示0 */
  83   3          }
  84   2          if (State != Next_State)
  85   2          {
  86   3            State = Next_State;/* Next_State 作用是帮助清屏 */
  87   3            OLED_Clear(); /* 状态切换清屏 */
  88   3          }
  89   2          
  90   2          switch (State)
  91   2          {
  92   3          case 0:
  93   3            if(Key==11)
  94   3            {
  95   4              Display--;
  96   4            }
  97   3            if(Key==15)
  98   3            {
  99   4              Display++;
 100   4            }
 101   3            Display%=2;
 102   3            Menu_Display(Display);
 103   3            break;
 104   3          case 1:
 105   3          {
 106   4            OLED_Printf(16,0,"Change Time");
 107   4            if(Key == 12)
 108   4            {
 109   5              Next_State = 0;
 110   5            }
 111   4          }break;
 112   3            
 113   3          case 2:
 114   3          if (Key)
 115   3          {
 116   4            LED = ~LED;
C51 COMPILER V9.60.0.0   MAIN                                                              06/29/2022 07:58:28 PAGE 3   

 117   4            OLED_Printf(1, 1, "%bd", Key);
 118   4          }
 119   3          if(Key == 12)
 120   3          {
 121   4            Next_State = 0;
 122   4          }
 123   3          break;
 124   3          }
 125   2        }
 126   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    370    ----
   CONSTANT SIZE    =    117    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      24
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
